import{_ as V}from"./AuthenticatedLayout-DLd4ty6c.js";import{o as m,c as f,w as t,a,u as i,h,g as b,b as _,d as r,r as k,f as D,q as x,F as I,s as A,Z as B,x as E,t as d}from"./app-AZ-p8ftd.js";import{_ as R,a as Y,b as H,c as w,d as p,e as T,f as u,h as L}from"./moment-DvLq_u30.js";import{P as j}from"./Pagination-D-0m9-Cj.js";import{_ as F,a as M,b as O,c as P,d as q,e as K,f as Z,g as C}from"./DeleteConfirmation-BQKVW9pE.js";import"./ApplicationLogo-DoR_VuKm.js";import"./CardContent-BJQNMp8d.js";var c=[];for(var $=0;$<256;++$)c.push(($+256).toString(16).slice(1));function z(n,e=0){return(c[n[e+0]]+c[n[e+1]]+c[n[e+2]]+c[n[e+3]]+"-"+c[n[e+4]]+c[n[e+5]]+"-"+c[n[e+6]]+c[n[e+7]]+"-"+c[n[e+8]]+c[n[e+9]]+"-"+c[n[e+10]]+c[n[e+11]]+c[n[e+12]]+c[n[e+13]]+c[n[e+14]]+c[n[e+15]]).toLowerCase()}var g,G=new Uint8Array(16);function J(){if(!g&&(g=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!g))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(G)}var Q=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const S={randomUUID:Q};function W(n,e,o){if(S.randomUUID&&!e&&!n)return S.randomUUID();n=n||{};var s=n.random||(n.rng||J)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,z(s)}const X={class:"text-slate-800 text-[15px] font-semibold underline mb-1 mt-3"},ee={class:"font-semibold"},te={props:{open:Boolean},emits:["close"]},N=Object.assign(te,{__name:"AlertDialog",setup(n){return(e,o)=>(m(),f(i(Z),{open:n.open},{default:t(()=>[a(i(K),null,{default:t(()=>[a(i(F),null,{default:t(()=>[e.$slots.title?(m(),f(i(M),{key:0,class:"text-red-600"},{default:t(()=>[h(e.$slots,"title")]),_:3})):b("",!0),e.$slots.subtitle||e.$slots.description?(m(),f(i(O),{key:1,class:"text-red-500"},{default:t(()=>[_("div",X,[h(e.$slots,"subtitle")]),_("div",ee,[h(e.$slots,"description")])]),_:3})):b("",!0)]),_:3}),h(e.$slots,"content"),a(i(P),null,{default:t(()=>[a(i(q),{onClick:o[0]||(o[0]=s=>e.$emit("close",!0))},{default:t(()=>[r("Close")]),_:1})]),_:1})]),_:3})]),_:3},8,["open"]))}}),ne=_("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Dashboard",-1),ae={class:"py-6"},ie={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-2"},oe=_("div",{class:"p-3"}," No Record Found ",-1),se={components:{DeleteConfirmation:C,AlertDialog:N},data(){return{device_name:"",confirmation:{is_open:!1,use_inertia:!1,id:"",route_name:"launch.check_device",method:"post",params:{confirm:!0},title:"",subtitle:"",description:""},alert_dialog:{is_open:!1,title:"",subtitle:"",description:""}}},methods:{checkStatus(n,e,o){localStorage.setItem("app-key",n),localStorage.setItem("app-school-code",e),localStorage.setItem("app-kit-id",o);var s=localStorage.getItem("app-token");s||(s=W(),localStorage.setItem("app-token",s)),A.post(route("launch.check_device",[n,s])).then(v=>{const l=v.data;l.launch&&this.launch(),l.first_device&&(this.confirmation.id=[n,s],this.confirmation.is_open=!0,this.confirmation.title="Device Name",this.confirmation.subtitle="",this.confirmation.description=""),l.new_device&&(this.confirmation.id=[n,s],this.confirmation.is_open=!0,this.confirmation.title="New Device Detected",this.confirmation.subtitle="Active Device: "+l.active_device_name,this.confirmation.description="You are trying to launch on a new device, are you sure?"),l.last_swap&&(this.confirmation.id=[n,s],this.confirmation.is_open=!0,this.confirmation.title="New Device Detected",this.confirmation.subtitle="Active Device: "+l.active_device_name,this.confirmation.description="You are about to reach maximum swap count for this key, if you need to reset the device limit please contact us."),l.device_limit_reached&&(this.alert_dialog.is_open=!0,this.alert_dialog.title="Device Limit Reached",this.alert_dialog.subtitle="",this.alert_dialog.description="Sorry, your have reached device limit. If you wish to reset the device limit, please contact us.")})},launch(){const n=route("launch"),e=document.createElement("form");e.action=n,e.method="POST";const o=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=document.createElement("input");s.type="hidden",s.name="_token",s.value=o,e.appendChild(s),e.appendChild(this.createHiddenInput("app_key",localStorage.getItem("app-key"))),e.appendChild(this.createHiddenInput("app_token",localStorage.getItem("app-token"))),e.appendChild(this.createHiddenInput("device_name",this.device_name)),document.body.appendChild(e),e.submit(),document.body.removeChild(e)},createHiddenInput(n,e){const o=document.createElement("input");return o.type="hidden",o.name=n,o.value=e,o}}},_e=Object.assign(se,{__name:"Dashboard",setup(n){return(e,o)=>{const s=k("Button"),v=k("Input");return m(),D(I,null,[a(i(B),{title:"Dashboard"}),a(V,null,{header:t(()=>[ne]),default:t(()=>[_("div",ae,[_("div",ie,[a(R,null,{title:t(()=>[r("Toddler App Keys")]),content:t(()=>[a(i(Y),null,{default:t(()=>[a(i(H),{class:"bg-gray-100"},{default:t(()=>[a(i(w),null,{default:t(()=>[a(i(p),null,{default:t(()=>[r("#")]),_:1}),a(i(p),{class:"whitespace-nowrap"},{default:t(()=>[r("Device Name")]),_:1}),a(i(p),{class:"whitespace-nowrap"},{default:t(()=>[r("Kit")]),_:1}),a(i(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Swap Count")]),_:1}),a(i(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Expiry Date")]),_:1}),a(i(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Action")]),_:1})]),_:1})]),_:1}),a(i(T),null,{default:t(()=>[e.$page.props.keys.data.length?b("",!0):(m(),f(i(w),{key:0},{default:t(()=>[a(i(u),{class:"text-center",colspan:"10"},{default:t(()=>[oe]),_:1})]),_:1})),(m(!0),D(I,null,E(e.$page.props.keys.data,(l,U)=>(m(),f(i(w),null,{default:t(()=>[a(i(u),null,{default:t(()=>[r(d(e.$page.props.keys.from+U),1)]),_:2},1024),a(i(u),{class:"whitespace-nowrap"},{default:t(()=>[r(d(l.device_name),1)]),_:2},1024),a(i(u),{class:"whitespace-nowrap"},{default:t(()=>{var y;return[r(d((y=l.kit_ref)==null?void 0:y.name),1)]}),_:2},1024),a(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[r(d(l.swap_count),1)]),_:2},1024),a(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[r(d(i(L)(l.expiry_date).format("DD MMM YYYY")),1)]),_:2},1024),a(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[a(s,{onClick:y=>e.checkStatus(l.key,l.school_ref.code,l.kit_id)},{default:t(()=>[r("Launch")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),a(j,{page_data:e.$page.props.keys},null,8,["page_data"])])])]),_:1}),a(C,{useInertia:e.confirmation.use_inertia,onSuccess:o[1]||(o[1]=l=>e.launch()),open:e.confirmation.is_open,onClose:o[2]||(o[2]=l=>e.confirmation.is_open=!1),routeName:e.confirmation.route_name,id:e.confirmation.id,method:e.confirmation.method,params:e.confirmation.params},x({title:t(()=>[r(d(e.confirmation.title),1)]),content:t(()=>[a(v,{type:"text",maxlength:"30",class:"text-slate-900",modelValue:e.device_name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.device_name=l),placeholder:"New Device Name"},null,8,["modelValue"])]),_:2},[e.confirmation.subtitle?{name:"subtitle",fn:t(()=>[r(d(e.confirmation.subtitle),1)]),key:"0"}:void 0,e.confirmation.description?{name:"description",fn:t(()=>[r(d(e.confirmation.description),1)]),key:"1"}:void 0]),1032,["useInertia","open","routeName","id","method","params"]),a(N,{open:e.alert_dialog.is_open,onClose:o[3]||(o[3]=l=>e.alert_dialog.is_open=!1)},{title:t(()=>[r(d(e.alert_dialog.title),1)]),description:t(()=>[r(d(e.alert_dialog.description),1)]),_:1},8,["open"])],64)}}});export{_e as default};
