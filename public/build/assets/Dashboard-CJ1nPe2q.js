import{_ as V}from"./AuthenticatedLayout-DoX62Ste.js";import{o as p,c as f,w as t,a as n,u as i,p as h,g as b,b as _,d as r,r as k,f as D,F as I,q as x,Z as A,s as B,t as d}from"./app-C7Ve4_6Z.js";import{_ as E,a as R,b as Y,c as w,d as m,e as H,f as u,h as T}from"./moment-BUv3Yl2o.js";import{P as L}from"./Pagination-B_P0DIhf.js";import{_ as j,a as F,b as M,c as O,d as P,e as q,f as K,g as C}from"./DeleteConfirmation-c8pdo7Av.js";import"./ApplicationLogo-BftLMJnC.js";import"./CardContent-BgNldJL2.js";var c=[];for(var $=0;$<256;++$)c.push(($+256).toString(16).slice(1));function Z(a,e=0){return(c[a[e+0]]+c[a[e+1]]+c[a[e+2]]+c[a[e+3]]+"-"+c[a[e+4]]+c[a[e+5]]+"-"+c[a[e+6]]+c[a[e+7]]+"-"+c[a[e+8]]+c[a[e+9]]+"-"+c[a[e+10]]+c[a[e+11]]+c[a[e+12]]+c[a[e+13]]+c[a[e+14]]+c[a[e+15]]).toLowerCase()}var g,z=new Uint8Array(16);function G(){if(!g&&(g=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!g))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(z)}var J=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const S={randomUUID:J};function Q(a,e,o){if(S.randomUUID&&!e&&!a)return S.randomUUID();a=a||{};var s=a.random||(a.rng||G)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Z(s)}const W={class:"text-slate-800 text-[15px] font-semibold underline mb-1 mt-3"},X={class:"font-semibold"},ee={props:{open:Boolean},emits:["close"]},N=Object.assign(ee,{__name:"AlertDialog",setup(a){return(e,o)=>(p(),f(i(K),{open:a.open},{default:t(()=>[n(i(q),null,{default:t(()=>[n(i(j),null,{default:t(()=>[e.$slots.title?(p(),f(i(F),{key:0,class:"text-red-600"},{default:t(()=>[h(e.$slots,"title")]),_:3})):b("",!0),e.$slots.subtitle||e.$slots.description?(p(),f(i(M),{key:1,class:"text-red-500"},{default:t(()=>[_("div",W,[h(e.$slots,"subtitle")]),_("div",X,[h(e.$slots,"description")])]),_:3})):b("",!0)]),_:3}),h(e.$slots,"content"),n(i(O),null,{default:t(()=>[n(i(P),{onClick:o[0]||(o[0]=s=>e.$emit("close",!0))},{default:t(()=>[r("Close")]),_:1})]),_:1})]),_:3})]),_:3},8,["open"]))}}),te=_("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Dashboard",-1),ae={class:"py-6"},ne={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-2"},ie=_("div",{class:"p-3"}," No Record Found ",-1),oe={components:{DeleteConfirmation:C,AlertDialog:N},data(){return{device_name:"",confirmation:{is_open:!1,use_inertia:!1,id:"",route_name:"launch.check_device",method:"post",params:{confirm:!0},title:"",subtitle:"",description:""},alert_dialog:{is_open:!1,title:"",subtitle:"",description:""}}},methods:{checkStatus(a,e,o){localStorage.setItem("app-key",a),localStorage.setItem("app-school-code",e),localStorage.setItem("app-kit-id",o);var s=localStorage.getItem("app-token");s||(s=Q(),localStorage.setItem("app-token",s)),x.post(route("launch.check_device",[a,s])).then(v=>{const l=v.data;l.launch&&this.launch(),l.first_device&&(this.confirmation.id=[a,s],this.confirmation.is_open=!0,this.confirmation.title="Device Name",this.confirmation.subtitle="",this.confirmation.description=""),l.new_device&&(this.confirmation.id=[a,s],this.confirmation.is_open=!0,this.confirmation.title="New Device Detected",this.confirmation.subtitle="Active device: "+l.active_device_name,this.confirmation.description="You are trying to launch on a new device, are you sure?"),l.last_swap&&(this.confirmation.id=[a,s],this.confirmation.is_open=!0,this.confirmation.title="New Device Detected",this.confirmation.subtitle="Active device: "+l.active_device_name,this.confirmation.description="You are about to reach maximum swap count for this key, if you need to reset the device limit please contact us."),l.device_limit_reached&&(this.alert_dialog.is_open=!0,this.alert_dialog.title="Device Limit Reached",this.alert_dialog.subtitle="",this.alert_dialog.description="Sorry, your have reached device limit. If you wish to reset the device limit, please contact us.")})},launch(){const a=route("launch"),e=document.createElement("form");e.action=a,e.method="POST";const o=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=document.createElement("input");s.type="hidden",s.name="_token",s.value=o,e.appendChild(s),e.appendChild(this.createHiddenInput("app_key",localStorage.getItem("app-key"))),e.appendChild(this.createHiddenInput("app_token",localStorage.getItem("app-token"))),e.appendChild(this.createHiddenInput("device_name",this.device_name)),document.body.appendChild(e),e.submit(),document.body.removeChild(e)},createHiddenInput(a,e){const o=document.createElement("input");return o.type="hidden",o.name=a,o.value=e,o}}},me=Object.assign(oe,{__name:"Dashboard",setup(a){return(e,o)=>{const s=k("Button"),v=k("Input");return p(),D(I,null,[n(i(A),{title:"Dashboard"}),n(V,null,{header:t(()=>[te]),default:t(()=>[_("div",ae,[_("div",ne,[n(E,null,{title:t(()=>[r("Toddler App Keys")]),content:t(()=>[n(i(R),null,{default:t(()=>[n(i(Y),{class:"bg-gray-100"},{default:t(()=>[n(i(w),null,{default:t(()=>[n(i(m),null,{default:t(()=>[r("#")]),_:1}),n(i(m),{class:"whitespace-nowrap"},{default:t(()=>[r("Device Name")]),_:1}),n(i(m),{class:"whitespace-nowrap"},{default:t(()=>[r("Kit")]),_:1}),n(i(m),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Swap Count")]),_:1}),n(i(m),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Expiry Date")]),_:1}),n(i(m),{class:"whitespace-nowrap text-center"},{default:t(()=>[r("Action")]),_:1})]),_:1})]),_:1}),n(i(H),null,{default:t(()=>[e.$page.props.keys.data.length?b("",!0):(p(),f(i(w),{key:0},{default:t(()=>[n(i(u),{class:"text-center",colspan:"10"},{default:t(()=>[ie]),_:1})]),_:1})),(p(!0),D(I,null,B(e.$page.props.keys.data,(l,U)=>(p(),f(i(w),null,{default:t(()=>[n(i(u),null,{default:t(()=>[r(d(e.$page.props.keys.from+U),1)]),_:2},1024),n(i(u),{class:"whitespace-nowrap"},{default:t(()=>[r(d(l.device_name),1)]),_:2},1024),n(i(u),{class:"whitespace-nowrap"},{default:t(()=>{var y;return[r(d((y=l.kit_ref)==null?void 0:y.name),1)]}),_:2},1024),n(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[r(d(l.swap_count),1)]),_:2},1024),n(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[r(d(i(T)(l.expiry_date).format("DD MMM YYYY")),1)]),_:2},1024),n(i(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[n(s,{onClick:y=>e.checkStatus(l.key,l.school_ref.code,l.kit_id)},{default:t(()=>[r("Launch")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),n(L,{page_data:e.$page.props.keys},null,8,["page_data"])])])]),_:1}),n(C,{useInertia:e.confirmation.use_inertia,onSuccess:o[1]||(o[1]=l=>e.launch()),open:e.confirmation.is_open,onClose:o[2]||(o[2]=l=>e.confirmation.is_open=!1),routeName:e.confirmation.route_name,id:e.confirmation.id,method:e.confirmation.method,params:e.confirmation.params},{title:t(()=>[r(d(e.confirmation.title),1)]),subtitle:t(()=>[r(d(e.confirmation.subtitle),1)]),description:t(()=>[r(d(e.confirmation.description),1)]),content:t(()=>[n(v,{type:"text",maxlength:"30",class:"text-slate-900",modelValue:e.device_name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.device_name=l),placeholder:"New Device Name"},null,8,["modelValue"])]),_:1},8,["useInertia","open","routeName","id","method","params"]),n(N,{open:e.alert_dialog.is_open,onClose:o[3]||(o[3]=l=>e.alert_dialog.is_open=!1)},{title:t(()=>[r(d(e.alert_dialog.title),1)]),description:t(()=>[r(d(e.alert_dialog.description),1)]),_:1},8,["open"])],64)}}});export{me as default};
