import{_ as D}from"./AuthenticatedLayout-CxqFsgVS.js";import{r as x,o as u,f as g,a as n,u as o,w as a,F as b,k as C,Z as U,b as h,d as r,c as y,g as w,l as N,t as l}from"./app-DTrnHkfb.js";import{_ as V,a as B,b as E,c as k,d as m,e as R,f as d,h as T}from"./moment-dxY_tt_N.js";import{P as L}from"./Pagination-BPsTcFJK.js";import{_ as S}from"./DeleteConfirmation-C5Vu_D_D.js";import"./ApplicationLogo-ALb6mTyG.js";import"./CardContent-DYlrkp-D.js";var i=[];for(var v=0;v<256;++v)i.push((v+256).toString(16).slice(1));function A(t,e=0){return(i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]).toLowerCase()}var _,H=new Uint8Array(16);function Y(){if(!_&&(_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!_))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _(H)}var F=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const I={randomUUID:F};function M(t,e,c){if(I.randomUUID&&!e&&!t)return I.randomUUID();t=t||{};var s=t.random||(t.rng||Y)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,A(s)}const P=h("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Dashboard",-1),j={class:"py-6"},K={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-2"},O=h("div",{class:"p-3"}," No Record Found ",-1),q={key:1,class:"text-red-500 py-2"},Z={components:{DeleteConfirmation:S},data(){return{confirmation:{is_open:!1,use_inertia:!1,id:"",route_name:"",method:"",params:"",title:"",description:""}}},methods:{checkStatus(t,e,c){localStorage.setItem("app-key",t),localStorage.setItem("app-school-code",e),localStorage.setItem("app-kit-id",c);var s=localStorage.getItem("app-token");s||(s=M(),localStorage.setItem("app-token",s)),C.post(route("launch.check_status",t),{platform:this.$device.os_name,browser:this.$device.browser_name,app_token:s}).then(p=>{p.data==100&&(this.confirmation.route_name="launch.check_status",this.confirmation.method="post",this.confirmation.id=t,this.confirmation.is_open=!0,this.confirmation.params={proceed:!0},this.confirmation.title="Last Device Swap",this.confirmation.description="This is your last device swap, if you need too reset the device limit please contact support."),p.data==200&&this.launch()})},launch(){const t=route("launch"),e=document.createElement("form");e.action=t,e.method="POST",e.target="_blank";const c=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=document.createElement("input");s.type="hidden",s.name="_token",s.value=c,e.appendChild(s),e.appendChild(this.createHiddenInput("app_key",localStorage.getItem("app-key"))),e.appendChild(this.createHiddenInput("app_token",localStorage.getItem("app-token"))),document.body.appendChild(e),e.submit(),document.body.removeChild(e)},createHiddenInput(t,e){const c=document.createElement("input");return c.type="hidden",c.name=t,c.value=e,c}}},te=Object.assign(Z,{__name:"Dashboard",setup(t){return(e,c)=>{const s=x("Button");return u(),g(b,null,[n(o(U),{title:"Dashboard"}),n(D,null,{header:a(()=>[P]),default:a(()=>[h("div",j,[h("div",K,[n(V,null,{title:a(()=>[r("Toddler App Keys")]),content:a(()=>[n(o(B),null,{default:a(()=>[n(o(E),{class:"bg-gray-100"},{default:a(()=>[n(o(k),null,{default:a(()=>[n(o(m),null,{default:a(()=>[r("#")]),_:1}),n(o(m),{class:"whitespace-nowrap"},{default:a(()=>[r("Device Name")]),_:1}),n(o(m),{class:"whitespace-nowrap"},{default:a(()=>[r("Kit")]),_:1}),n(o(m),{class:"whitespace-nowrap text-center"},{default:a(()=>[r("Swap Count")]),_:1}),n(o(m),{class:"whitespace-nowrap text-center"},{default:a(()=>[r("Expiry Date")]),_:1}),n(o(m),{class:"whitespace-nowrap text-center"},{default:a(()=>[r("Action")]),_:1})]),_:1})]),_:1}),n(o(R),null,{default:a(()=>[e.$page.props.keys.data.length?w("",!0):(u(),y(o(k),{key:0},{default:a(()=>[n(o(d),{class:"text-center",colspan:"10"},{default:a(()=>[O]),_:1})]),_:1})),(u(!0),g(b,null,N(e.$page.props.keys.data,(p,$)=>(u(),y(o(k),null,{default:a(()=>[n(o(d),null,{default:a(()=>[r(l(e.$page.props.keys.from+$),1)]),_:2},1024),n(o(d),{class:"whitespace-nowrap"},{default:a(()=>[r(l(p.device_name),1)]),_:2},1024),n(o(d),{class:"whitespace-nowrap"},{default:a(()=>{var f;return[r(l((f=p.kit_ref)==null?void 0:f.name),1)]}),_:2},1024),n(o(d),{class:"whitespace-nowrap text-center"},{default:a(()=>[r(l(p.swap_count),1)]),_:2},1024),n(o(d),{class:"whitespace-nowrap text-center"},{default:a(()=>[r(l(o(T)(p.expiry_date).format("DD MMM YYYY")),1)]),_:2},1024),n(o(d),{class:"whitespace-nowrap text-center"},{default:a(()=>[p.swap_count!=3?(u(),y(s,{key:0,onClick:f=>e.checkStatus(p.key,p.school_ref.code,p.kit_id)},{default:a(()=>[r("Launch")]),_:2},1032,["onClick"])):w("",!0),p.swap_count==3?(u(),g("div",q,"Device Limit Reached")):w("",!0)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),n(L,{page_data:e.$page.props.keys},null,8,["page_data"])])])]),_:1}),n(S,{useInertia:e.confirmation.use_inertia,onSuccess:c[0]||(c[0]=p=>e.launch()),open:e.confirmation.is_open,onClose:c[1]||(c[1]=p=>e.confirmation.is_open=!1),routeName:e.confirmation.route_name,id:e.confirmation.id,method:e.confirmation.method,params:e.confirmation.params},{title:a(()=>[r(l(e.confirmation.title),1)]),description:a(()=>[r(l(e.confirmation.description),1)]),_:1},8,["useInertia","open","routeName","id","method","params"])],64)}}});export{te as default};
